<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>

  <head>
    <meta charset="utf-8">
      <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
      <title>Multi Factor User Store </title>
      <meta name="viewport" content="width=device-width">
      <meta name="title" content="Multi Factor User Store ">
    
      <link rel="shortcut icon" href="../../favicon.ico">
      <link rel="stylesheet" href="../../styles/docfx.vendor.min.css">
      <link rel="stylesheet" href="../../styles/docfx.css">
      <link rel="stylesheet" href="../../styles/main.css">
      <meta property="docfx:navrel" content="../../toc.html">
      <meta property="docfx:tocrel" content="../toc.html">
    
    
    
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper" class="ra-royalserver">
      <header>

        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>

              <a class="navbar-brand" href="https://www.royalapps.com/?return_to_last_selected_page">
                <img id="logo" class="svg" src="../../logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>

        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div role="main" class="container body-content hide-when-search">

        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="royalserver_general_multifactor-user-store">

<img src="/r2023/images/RoyalServer/Svg/SVG_Permissions_32.svg" class="icon-left icon-lg" alt="">
<h1 id="multi-factor-user-store">Multi Factor User Store</h1>
<p>The <strong>Multi Factor User Store</strong> panel displays the users configured for Multi Factor authentication.</p>
<h2 id="show-or-activate-the-multi-factor-users-store-panel">Show or Activate the Multi Factor Users Store Panel</h2>
<p>In The Royal Server Configuration Tool Navigation Bar, click on the <strong>General</strong> group and then on the <strong>Multi Factor Users Store</strong> entry.</p>
<p>The data grid shows the configured users for multi-factor authentication.</p>
<h2 id="adding-a-user-for-multi-factor-authentication">Adding a User for Multi-Factor Authentication</h2>
<p>The following functionalities in Royal Server support Multi-Factor Authentication:</p>
<ul>
<li>Document Store (triggered when loading or saving a document hosted by Royal Server) or</li>
<li>Secure Gateway Connections.</li>
<li>Click on <strong>Add...</strong>.</li>
<li>Enter a user or click on the <strong>Select User...</strong> icon.</li>
<li>Specify an optional comment.</li>
<li>Select for which feature this user is required to present a second factor (Document Store and/or Secure Gateway)</li>
<li>Specify the caching time. Each successful authentication is then cached for the specified minutes.</li>
<li>Select an MFA provider. Currently, &quot;Generic TOTP&quot;, &quot;Duo&quot; and &quot;YubiKey&quot; are supported. Depending on your selection, different additional information will be required.</li>
</ul>
<div class="NOTE">
<h5>Note</h5>
<p>A Caching Time of 0 minutes means no caching and the user has to provide a second factor for every operation.</p>
</div>
<h3 id="configuring-generic-totp">Configuring Generic TOTP</h3>
<p>Provide meaningful values for Issuer and Label (these are displayed in the Authenticator Apps on your phone).
After completion, a secret will be generated and represented as a QR code for each user. This secret or QR code is needed by the user to create a new entry in the Authenticator app on the mobile phone. This secret and/or QR code need to be sent in a secure way to the user.</p>
<div class="NOTE">
<h5>Note</h5>
<p>You can always show the generated secret again by clicking on the <strong>Edit...</strong> icon for TOTP configured users.</p>
</div>
<div class="WARNING">
<h5>Warning</h5>
<p><strong>TOTP time sensitivity</strong><br>
The machine where Royal Server is installed and the device where the TOTP Authenticator App is running need to have correct time settings in order to make TOTP work. Use Time Services to ensure this.</p>
</div>
<p><strong>TOTP Self-Service</strong></p>
<p>Alternatively, the user can be allowed to use a web based self-service workflow by checking the <strong>Allowed</strong> under <strong>Self Service</strong>.</p>
<p>If self-service is allowed, the user needs to login to the Royal Server Website (https://[IpAddress]:[Port]) using the user provisioned for TOTP and then navigate to &quot;TOTP Self Service&quot;. He will be presented with his secret/QR code to configure his authenticator app. As soon as he has configured the app, he needs to enter a second factor for verification. Once verified, the workflow will be closed and cannot be accessed anymore.</p>
<p>After refreshing the grid in the Royal Server Configuration Tool and opening &quot;Edit&quot;-dialog for the user, he will be flagged as <strong>Verified</strong> under <strong>Self Service</strong>. In order to reset the workflow, so that the user can access it again, just uncheck <strong>Verified</strong>.</p>
<h3 id="configuring-duo">Configuring DUO</h3>
<p>Provide the DUO user Id that corresponds with the user you are configuring for Multi-Factor Authentication.</p>
<div class="NOTE">
<h5>Note</h5>
<p>Check the <a href="mfa.html#duo">configuration of the DUO provider</a></p>
</div>
<h3 id="configuring-yubikey">Configuring YubiKey</h3>
<p>Configuring YubiKey requires the input of the YubiKey ID e.g. by connecting the YubiKey to the machine and pressing the button on the YubiKey device.</p>
<div class="NOTE">
<h5>Note</h5>
<p>Check the <a href="mfa.html#yubikey">configuration of the YubiKey provider</a></p>
</div>
</article>
          </div>

          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="form p-e2">
                <div class="form-group">
                  <label for="version-select">Version</label>
                  <select id="version-select" class="form-control">
                    <option value="r2023">Royal TS V7 / Royal Server V5</option>
                    <option value="r2021">Royal TS V6 / Royal Server V4</option>
                  </select>
                </div>
              </div>    
              <div class="contribution">
                <ul class="nav">
                  <li>
                    <a href="https://github.com/royalapplications/docs/blob/main/src/r2023/royalserver/general/mfa-user-store.md/#L1" class="contribution-link">Improve this Doc</a>
                  </li>
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
                <h5>In This Article</h5>
                <div></div>
              </nav>    
            </div>
  
          </div>
        </div>
      </div>

      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            <a rel="me" href="https://dotnet.social/@royalapps">&nbsp;</a>
      
      <span>Copyright © <strong>Royal Apps</strong></span>
          </div>
        </div>
      </footer>
    </div>

    <script type="text/javascript" src="../../styles/docfx.vendor.min.js"></script>
    <script type="text/javascript" src="../../styles/docfx.js"></script>
    <script type="text/javascript" src="../../styles/ra.vendor.js"></script>
    <script type="text/javascript" src="../../styles/main.js"></script>
  </body>
</html>
