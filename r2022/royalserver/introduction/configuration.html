<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Royal Server Configuration </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Royal Server Configuration ">
    <meta name="generator" content="docfx 2.59.4.0">
    
    <link rel="shortcut icon" href="../../favicon.ico">
    <link rel="stylesheet" href="../../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../../styles/docfx.css">
    <link rel="stylesheet" href="../../styles/main.css">
    <meta property="docfx:navrel" content="../../toc.html">
    <meta property="docfx:tocrel" content="../toc.html">
    
    
    
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper" class="ra-royalserver">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../../index.html">
                <img id="logo" class="svg" src="../../logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>
        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="royalserver_introduction_configuration">
<h1 id="royal-server-configuration">Royal Server Configuration</h1>

<p>There are various options how manged Royal Server configuration settings.</p>
<h2 id="royal-server-configuration-tool">Royal Server Configuration Tool</h2>
<p>The most common way is to use the <code>Royal Server Configuration Tool</code> which provides a graphical user interface to modify the configuration, and the possibility to stop and (re)start the server. You can use it to manage the different Royal Server components, your license(s), set up certificates, and grant permissions, etc.. Additionally, it includes a health monitor to easily monitor resource usage.</p>
<h2 id="configuration-file">Configuration File</h2>
<p>Royal Server V4 stores the configuration settings in a file which can be found here: <code>%ProgramData%\RoyalServer\appsettings.json</code>.</p>
<p>If not present on start-up, <code>appsettings.json </code> will automatically be generated.</p>
<div class="NOTE">
<h5>Note</h5>
<p>Settings from a previous Royal Server V3 installation will be automatically imported.</p>
</div>
<p>You can modify this file with any text editor. After any change, a restart of Royal Server is required.
You can do this either with the Configuration Tool or via a commandline:</p>
<pre><code>net stop RoyalServer &amp;&amp; net start RoyalServer
</code></pre>
<div class="NOTE">
<h5>Note</h5>
<p>There are a couple of sensitive settings that can only be managed via the Royal Server Configuration Tool to keep them properly protected:</p>
<ul>
<li>Worker Account Settings</li>
<li>Proxy Settings</li>
<li>MFADuoSecretKey</li>
<li>MFADuoIntegrationKey</li>
<li>MFADuoHost</li>
</ul>
</div>
<h2 id="environment-variables">Environment Variables</h2>
<p>As of Royal Server V4 you can optionally pass configuration values using environment variables.</p>
<p>Environment variables have to be prefixed with <code>RS_</code> followed by the corresponding key name in <code>appsettings.json</code>.
As for hierarchical keys, the separator is a double underscore (<code>__</code>).</p>
<p><em>Examples:</em></p>
<pre><code>set RS_IPAddress=&quot;127.0.0.1&quot;
set RS_Port=8888,
set RS_SecureGateway__GatewayEnabled=false
</code></pre>
<div class="NOTE">
<h5>Note</h5>
<p>Be aware that these overwrites are neither shown in the Configuration Tool.</p>
</div>
<h2 id="configuration-of-managed-servers">Configuration of Managed Servers</h2>
<p>Royal Server manages remote server via different Modules. These require specific protocols to work:</p>
<table>
<thead>
<tr>
<th>Module</th>
<th>Protocol</th>
<th>Remark</th>
</tr>
</thead>
<tbody>
<tr>
<td>Eventlog</td>
<td>WMI/CIM</td>
<td>user needs to have the rights to read the Windows eventlog</td>
</tr>
<tr>
<td>Hyper-V</td>
<td>WMI/CIM</td>
<td></td>
</tr>
<tr>
<td>Processes</td>
<td>WMI/CIM</td>
<td></td>
</tr>
<tr>
<td>RoyalDocumentStore</td>
<td>-</td>
<td>internal module used by Royal Server</td>
</tr>
<tr>
<td>RoyalServerManagement</td>
<td>-</td>
<td>internal module used by Royal Server</td>
</tr>
<tr>
<td>Script</td>
<td>WMI/CIM</td>
<td>PowerShell remoting for PS</td>
</tr>
<tr>
<td>Terminal Services</td>
<td>WTS API</td>
<td>Proprietary protocol by Microsoft</td>
</tr>
<tr>
<td>VM Ware</td>
<td>WMI/CIM</td>
<td></td>
</tr>
<tr>
<td>Windows Services</td>
<td>WMI/CIM</td>
<td></td>
</tr>
</tbody>
</table>

<p>The easiest way to achieve that a remote server can be managed is via the following two steps:</p>
<ol>
<li>Enable-PSRemoting</li>
<li>Firewall should let through Royal Server traffic</li>
</ol>
<h3 id="1-enable-psremoting">1. Enable-PSRemoting</h3>
<p>Most of the Management Endpoint modules are based on WMI. To enable the proper configuration for remote WMI calls, you need to execute the Enable-PSRemoting command in an elevated PowerShell console.</p>
<h3 id="2-firewall-settings">2. Firewall Settings</h3>
<p>In case the Windows Firewall is enabled the following two rules must be enabled:</p>
<ul>
<li>Windows Management Instrumentation (WMI-In), and</li>
<li>Windows Management Instrumentation (DCOM-In)</li>
</ul>
<p>For the above two steps, we have also prepared a PowerShell script (in <code>&lt;royal-server-installation-dir&gt;\scripts\prepare_server.ps1</code>). See the <a href="xref:royalserver_advanced_management-scripts_pepare">Preparing a Managed Server</a> chapter.</p>
</article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                  <li>
                    <a href="https://github.com/royalapplications/docs/blob/main/src/r2022/royalserver/introduction/configuration.md/#L1" class="contribution-link">Improve this Doc</a>
                  </li>
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
                <h5>In This Article</h5>
                <div></div>
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            
            <span>Copyright © <strong>Royal Apps</strong></span>
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../../styles/docfx.js"></script>
    <script type="text/javascript" src="../../styles/ra.vendor.js"></script>
    <script type="text/javascript" src="../../styles/main.js"></script>
  </body>
</html>
